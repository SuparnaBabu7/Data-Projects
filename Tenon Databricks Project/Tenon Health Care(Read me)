ğğ®ğ¢ğ¥ğğ¢ğ§ğ  ğšğ§ ğ„ğ§ğ-ğ­ğ¨-ğ„ğ§ğ ğ‡ğğšğ¥ğ­ğ¡ğœğšğ«ğ ğƒğšğ­ğš ğğ¢ğ©ğğ¥ğ¢ğ§ğ ğ”ğ¬ğ¢ğ§ğ  ğ€ğ³ğ®ğ«ğ ğƒğšğ­ğšğ›ğ«ğ¢ğœğ¤ğ¬

ğ‘°ğ’ğ’•ğ’“ğ’ğ’…ğ’–ğ’„ğ’•ğ’Šğ’ğ’
In today's data-driven world, healthcare organizations require robust data pipelines to process, analyze, and visualize patient data efficiently. In this blog, we will explore how we implemented an end-to-end data pipeline for Tenon Health Care using Azure Databricks, ensuring seamless data flow from multiple sources to Power BI for reporting.

ğ‘·ğ’“ğ’ğ’‹ğ’†ğ’„ğ’• ğ‘¶ğ’—ğ’†ğ’“ğ’—ğ’Šğ’†ğ’˜
The project involved integrating data from multiple sources, including Azure Cosmos DB, on-premises MySQL, and Azure Blob Storage. We leveraged Azure Data Factory (ADF) for ETL, Azure Key Vault for security, and Databricks for data transformations. The final dataset was stored in Azure SQL Database and visualized in Power BI.

ğ—¦ğ˜ğ—²ğ—½-ğ—¯ğ˜†-ğ—¦ğ˜ğ—²ğ—½ ğ—œğ—ºğ—½ğ—¹ğ—²ğ—ºğ—²ğ—»ğ˜ğ—®ğ˜ğ—¶ğ—¼ğ—»

1. ğ‘ºğ’†ğ’•ğ’•ğ’Šğ’ğ’ˆ ğ‘¼ğ’‘ ğ‘«ğ’‚ğ’•ğ’‚ ğ‘ºğ’•ğ’ğ’“ğ’‚ğ’ˆğ’† ğ’‚ğ’ğ’… ğ‘ºğ’ğ’–ğ’“ğ’„ğ’†ğ’”

Azure Cosmos DB: Hosted Claims.csv file.

On-Premises MySQL: Contained hospital-related data.

Azure Blob Storage: Uploaded CSV files including diseases, groups, sub-groups, patients, and subscribers.

2. ğ‘ªğ’“ğ’†ğ’‚ğ’•ğ’Šğ’ğ’ˆ ğ‘¨ğ’›ğ’–ğ’“ğ’† ğ‘«ğ’‚ğ’•ğ’‚ ğ‘­ğ’‚ğ’„ğ’•ğ’ğ’“ğ’š (ğ‘¨ğ‘«ğ‘­) ğ‘·ğ’Šğ’‘ğ’†ğ’ğ’Šğ’ğ’†ğ’”

Built linked services to connect Blob Storage, Cosmos DB, and Azure SQL Database.

Configured Azure Key Vault to securely store connection credentials.

Granted access to ADF in Key Vault.

3. ğ‘«ğ’‚ğ’•ğ’‚ ğ‘°ğ’ğ’ˆğ’†ğ’”ğ’•ğ’Šğ’ğ’ ğ’‚ğ’ğ’… ğ‘»ğ’“ğ’‚ğ’ğ’”ğ’‡ğ’ğ’“ğ’ğ’‚ğ’•ğ’Šğ’ğ’ ğ‘·ğ’Šğ’‘ğ’†ğ’ğ’Šğ’ğ’†ğ’”

Raw to Bronze: Loaded claims data from Cosmos DB to the raw layer using ADF pipelines.

Bronze to Silver: Created a raw2bronze_PL pipeline to move and clean data.

Silver to Gold: Developed Tenon_main_PL, a master pipeline orchestrating all transformations.

4. ğ‘«ğ’‚ğ’•ğ’‚ ğ‘»ğ’“ğ’‚ğ’ğ’”ğ’‡ğ’ğ’“ğ’ğ’‚ğ’•ğ’Šğ’ğ’ ğ’Šğ’ ğ‘«ğ’‚ğ’•ğ’‚ğ’ƒğ’“ğ’Šğ’„ğ’Œğ’”

Created a Databricks workspace and a Tenon folder to manage notebooks.

Configured connectors for various storage accounts.

ğ‘°ğ’ğ’‘ğ’ğ’†ğ’ğ’†ğ’ğ’•ğ’†ğ’… ğ’„ğ’ğ’†ğ’‚ğ’ğ’Šğ’ğ’ˆ ğ’‚ğ’ğ’… ğ’—ğ’‚ğ’ğ’Šğ’…ğ’‚ğ’•ğ’Šğ’ğ’ ğ’”ğ’•ğ’†ğ’‘ğ’” ğ’Šğ’ ğ’…ğ’†ğ’…ğ’Šğ’„ğ’‚ğ’•ğ’†ğ’… ğ’ğ’ğ’•ğ’†ğ’ƒğ’ğ’ğ’Œğ’”:

Hospital_transformations
Groups_transformations
Sub-Groups_transformations
Disease_transformations
Patient_transformations
Claims_transformations
Subscribers_transformations

Performed data joins in tenon-spb-workspace-silver.

Consolidated all transformations in silver_transformation and wrote the final dataset to the Gold Layer.

5. ğ‘¾ğ’“ğ’Šğ’•ğ’Šğ’ğ’ˆ ğ‘«ğ’‚ğ’•ğ’‚ ğ’•ğ’ ğ‘¨ğ’›ğ’–ğ’“ğ’† ğ‘ºğ‘¸ğ‘³ ğ‘«ğ’‚ğ’•ğ’‚ğ’ƒğ’‚ğ’”ğ’†

Generated an authentication token for ADF to connect with Databricks.

Created a new notebook to write the final dataset to Azure SQL Database.

Added code in silver_transformation to store data as a Delta Table in Databricks.

6. ğ‘­ğ’Šğ’ğ’‚ğ’ğ’Šğ’›ğ’Šğ’ğ’ˆ ğ’•ğ’‰ğ’† ğ‘«ğ’‚ğ’•ğ’‚ ğ‘·ğ’Šğ’‘ğ’†ğ’ğ’Šğ’ğ’†

Developed SILVER2BRONZE2ASQLDB pipeline to load the cleaned data into Azure SQL Database.

Integrated this pipeline into Tenon_main_PL.

Successfully ran the main pipeline, ensuring data flow from raw to gold.

7. ğ‘·ğ’ğ’˜ğ’†ğ’“ ğ‘©ğ‘° ğ‘«ğ’‚ğ’”ğ’‰ğ’ƒğ’ğ’‚ğ’“ğ’… ğ‘«ğ’†ğ’—ğ’†ğ’ğ’ğ’‘ğ’ğ’†ğ’ğ’•

Pulled the final dataset from Azure SQL Database into Power BI.

Designed interactive reports for healthcare insights.

Shared the dashboard with end users for real-time analytics.

ğ…ğ¢ğ§ğšğ¥ ğğ®ğ­ğœğ¨ğ¦ğ

âœ… Tenon_final_csv generated in the Gold Layer.
âœ… Tenon_TB table stored in Azure SQL Database.
âœ… Delta Table created in Databricks.
âœ… Power BI Report delivered to stakeholders.

ğ—–ğ—¼ğ—»ğ—°ğ—¹ğ˜‚ğ˜€ğ—¶ğ—¼ğ—»

This project demonstrated the power of Azure Databricks in handling large-scale healthcare data. By integrating Cosmos DB, MySQL, Blob Storage, ADF, Databricks, and Power BI, we built a scalable, secure, and efficient data pipeline. The end result? A robust healthcare analytics solution that empowers stakeholders with data-driven insights.


